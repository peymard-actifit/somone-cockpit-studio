Sans toucher au fonctionnement des autres types de vues domaines. Je veux créer une nouvelle vue Domaines, appelée Vue "Alertes", au même niveau que les vues Grille, Standard, etc. Dans cette vue il doit y avoir deux parties, séparées par un trait horizontal déplaçable en drag & drop pour ajuster les hauteurs de la partie haute et de la partie basse. En bas de la vue Alertes, on verra une liste d'incidents, avec un incident par ligne, triable par colonne, avec comme colonnes : La couleur de l'incident (orange, rouge, violet), la date de démarrage, la date de fin, la durée, le domaine, la catégorie, l'élément, la sous-catégorie, le sous-élément, une description expliquant l'élément (il sera possible de joindre un fichier à une ligne d'incident pour améliorer la description avec des données externes). Les colonnes peuvent être toutes redimensionnées en drag & drop. La dernière ligne permet d'en ajouter une autre avec pour chaque colonne la possibilité de choisir parmi les options disponibles (choix d'une des trois couleurs, choix de date de démarrage, de fin, durée non éditable et remplie automatiquement, d'abord choix d'un domaine parmi les domaines existants (catégories et suites sont non éditables), puis quand le domaine est choisi choix d'une catégorie (tous les suivants sont non éditables), puis quand la catégorie est choisie choix d'un élément, puis la suite dans la même logique, enfin remplir la fin de la ligne avec la description. Au final on doit avoir une liste d'incidents qui soit claire avec chacun sur une ligne, la possibilité (par un petit bouton comme sur les Eléments - petite poubelle rouge) de les supprimer individuellement, et des titres de colonnes qui permettent de filtrer, de trier par colonne, et de sélectionner des plages de dates ou des valeurs affichées dans la liste des valeurs existantes. La partie haute de la vue Alertes doit être constituée de 4 tuiles horizontalement côtés à côtés, de couleur adaptées, comportant les intitulés suivants : Total des alertes, Alertes fatales, Alertes critiques, Alertes mineures (risques), avec des icônes associées et surtout le nombre d'alertes dans chaque tuile correspondant à ce qui est dans la liste en dessous visible. Pour la partie haute, je donne colle un exemple à ce prompt. Les données de cette vue domaine seront stockées dans la base de données et seront persistantes comme les autres éléments pour une maquette éditée par le studio. Cette vue fera l'objet aussi d'un menu d'édition masquable sur la droite comme les autres vues, et dans les préférences d'affichage on pourra régler l'espacement entre les lignes d'incidents de la partie basse et la hauteur des tuiles dans la partie haute.

Les couleurs des tuiles de la vue Alertes doivent être exactement les mêmes que dans les autres vues (pour violet, rouge et orange). La tuiles de total des alertes doit avoir la couleur bleue définies dans les autres vues. Dans les colonnes de la vue en bas, la sélection des couleurs doit se faire en sélectionnant des couleurs et non pas des criticités d'alertes. Sur la ligne on doit donc pouvoir choir du rouge, orange et violet sans texte associé (même si le texte est bien stocké derrière). Pour les dates la case doit être plus large afin de pouvoir écrire directement la date ou choisir le modal pour la sélectionner. Pour les heures dans les dates, l'interface doit être plus simple à utiliser. La date de fin doit être systématiquement supérieure à la date de début (ne pas proposer des dates avant celle de début). Quand on sort de la vue Alertes, toutes les données encours d'édition sont mémorisées et ne sont pas remises à zéro quand on revient sur la Vue Alertes. Dans le modal d'édition des dates, un bouton Ok est affiché pour sortir du modal (même si on peut sortir aussi en cliquant à côté). Dans le menu d'édition de la Vue Alertes, il faut changer le nom du sous-menu Configuration des alertes en Préférences d'affichage. Il faut enlever le slider de Position du séparateur. Il faut enlever la partie Statistiques qui est dans le sous-menu pour la remonter juste en dessous du nom du domaine en haut du menu (comme les prévisualisation des éléments et sous-éléments. Un bouton dupliquer l'alerte doit être mis à côté du bouton de suppression. Un bouton éditer doit permettre d'éditer la ligne directement dans la liste. Si je double clique sur un ligne verticale d'espacement de colonne, la colonne à gauche de la ligne est justifiée (ressérée au maximum possible pour une vue complète des lignes de la colonne. Enlève l'information inutile dans le sous-menu Configuration (que tu dois renommer) du menu d'édition de la Vue Alertes. Lors de la publication de la maquette, tu penses bien à supprimer en publication la vue sur tous les éléments d'édition de la Vue Alerte comme tu le fais pour les autres vues.

Quand on duplique une ligne d'incident (on va appeler cela une ligne d'alerte), on doit aussi dupliquer les dates de début et de fin. Quand j'édite une ligne d'alerte déjà créée, je veux pouvoir ne pas valider (une croix à côté du check de validation) et revenir aux valeur de la ligne avant son édition. Par défaut, les tuiles du haut sont les moins hautes possibles (ce qu'on peut faire de plus fin avec la barre de reglage de leur hauteur). A côté du bouton de filtre, dans toutes les colonnes sauf la description, il doit y avoir un bouton de tri alphabétique (flêche vers le haut, bas, non trié), et même un bouton de tri pour les couleurs (de orange à violet ou inversement), comme dans la colonne début. Les tris sont cumulatifs (si deux valeurs sont identiques dans une colonne et qu'y fait un tri, l'ordre des alertes qui ont la même valeur dans la colonne dépend de l'ordre précédemment obtenu). Quand un filtre ou un tri rest appliqué, l'icone de filtre ou de tri est surligné dans la colonne. On peut enlever le slider de hauteur des tuiles, l'affichage de la hauteur étant reglable en drag & drop par la ligne horizontale de milieu de vue. La maquette publiée n'affiche pas le contenu de la Vue Alertes.

Pour la publication, je veux la liste des alertes (et s'il y en a plus que la hauteur de la zone du bas, une gestion avec un ascenceur, bien sûr).

Dans la vue "Alertes", rajoute dans la liste des alertes une colonne "Responsable" avant la colonne description.
Ce champ "Responsable" dans chaque alerte peut avoir deux valeurs : Oui et Non.
Par défaut, le champ est initialisé à "Oui" (dans les alertes déjà créées et qui n'avaient pas le champs et dans le champs des alertes à créer).

Je veux créer maintenant une nouvelle vue Domaines appelée Vue "Stats".
Dans cette vue, je veux voir deux parties, une partie du haut et une partie du bas, avec entre les deux parties une barre horizontale qui me permette de les redimensionner en hauteur en drag & drop.
Dans la partie du haut, je veux voir un graphe en barres empilées calées à 100%, avec en abscisse des périodes (jour, semaines, mois, années - une seule période pour le graphe et un nombre de période à définir) et en ordonnées des %.
Les barres empilées sont vertes, bleues et rouge (les mêmes couleurs que pour le reste du studio).
Pour chaque période, on calculera le "temps de service" qui sera la somme des temps d'ouverture du service par jours inclus dans la période.
Dans le menu d'édition de la vue Stats, un sous-menu nommé "Paramètres du graphe" permettra de fixer : la plage horaire de service sur une journée (avec une sélection des heures considérées comme ouvertes sur une semaine d'activité (sélection par heure), répétables sur une période plus large que la semaine) (par défaut la plage horaire de service sera de 8h à 18h tous les jours de la semaine). Une case à cocher si on veut exclure les week-ends de la plage de service. Une case à cocher pour savoir si on veut exclure les jours féries. Un champ permettant d'exclure des jours calendaires particuliers.
Une fois que cette définition est faite de la plage de service, en fonction de la période définie (dans le même sous menu) pour l'abscisse des barres du graphe, cela va donner par barre le temps d'ouverture du service par barre. Ce temps total correspond à 100%. Il sera ensuite divisé en trois couleur telles que décrites auparavant. Le vert est la couleur du temps pendant lequel Aucune alerte critique ou fatale n'est active sur la période. Le Bleu correspond au temps pendant lequel au moins une alerte avec "Responsable" à "Non" est déclenchée, mais pendant lequel aucune alerte critique ou fatale avec "Responsable" à "Oui" n'est présente, et le rouge correspond au reste (complétude à 100%). On aura donc des barres cumulées avec du vert en bas, puis du bleu, puis du rouge (parfois il n'y aura pas de bleu, et éventuellement pas de rouge, ce n'est pas grave tant que le cumul à 100% est présent et que toutes les barres sont bien de même taille à 100%.
Dans la partie du bas, je veux la même abscisse (par période) et je veux que les graphes de la partie haute et de la partie basse soient bien alignés l'un au dessus de l'autre avec les mêmes périodes bien alignées entre elles.
Au dessus des périodes, un graphique en barre cumulées correspond à la durée de chaque alerte, en barres cumulées par alerte, avec un dégradé de couleur en fonction de l'Elément correspondant à chaque alerte. Une légende sur les couleurs et les Catégories/Eléments concernés est présente à gauche ou à droite du graphe selon la place restante et en ne cassant pas au global l'alignement du graphe du haut et du bas pour que les périodes soient bien alignées entre elles.
On est donc bien sur un graphe représentant les vraies durées des alertes et qui sera visuellement mis en parallèle graphiquement entre la partie haute et la partie basse.
Je te donne un exemple graphique du résultat dans le prompt en pièce jointe.








